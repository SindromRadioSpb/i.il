name = "iil"
main = "src/index.ts"
compatibility_date = "2026-02-27"

# Default (dev) D1 binding
[[d1_databases]]
binding = "DB"
database_name = "news_hub_dev"
database_id = "3e74b9fd-b0b3-4022-ac3d-d08306015420"

# Default vars (dev defaults — safe: cron and FB disabled)
# ANTHROPIC_API_KEY is a secret — set via: wrangler secret put ANTHROPIC_API_KEY
[vars]
CRON_ENABLED = "false"
FB_POSTING_ENABLED = "false"
ADMIN_ENABLED = "false"
CRON_INTERVAL_MIN = "10"
MAX_NEW_ITEMS_PER_RUN = "25"
SUMMARY_TARGET_MIN = "400"
SUMMARY_TARGET_MAX = "700"
ANTHROPIC_MODEL = "claude-haiku-4-5-20251001"

# Cron trigger (registered for both dev and production)
[triggers]
crons = ["*/10 * * * *"]

# ── Production environment ────────────────────────────────────────────────────
[env.production]

[[env.production.d1_databases]]
binding = "DB"
database_name = "news_hub_prod"
database_id = "32403483-6512-4673-aaff-a3a6e3c9aad3"

# Explicit production vars (CRON_ENABLED and FB_POSTING_ENABLED set to false
# until manually verified; change in dashboard or here when ready to go live)
# ANTHROPIC_API_KEY is a secret — set via: wrangler secret put ANTHROPIC_API_KEY --env production
[env.production.vars]
CRON_ENABLED = "false"
FB_POSTING_ENABLED = "false"
ADMIN_ENABLED = "false"
CRON_INTERVAL_MIN = "10"
MAX_NEW_ITEMS_PER_RUN = "25"
SUMMARY_TARGET_MIN = "400"
SUMMARY_TARGET_MAX = "700"
ANTHROPIC_MODEL = "claude-haiku-4-5-20251001"

[env.production.triggers]
crons = ["*/10 * * * *"]
